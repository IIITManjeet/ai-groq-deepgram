(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6954:function(e,r,t){Promise.resolve().then(t.bind(t,9571))},9571:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return o}});var n=t(7437),a=t(2265),s=t(6648),c=function(e,r){switch(r.type){case"reset":return{messages:[],finalTranscripts:[],interimTranscript:""};case"transcript_interim":return{...e,interimTranscript:r.content};case"transcript_final":return{...e,finalTranscripts:[...e.finalTranscripts,r.content],interimTranscript:""};case"assistant":{let t=[];return e.finalTranscripts.length>0&&t.push({role:"user",content:e.finalTranscripts.join(" ")}),t.push({role:"assistant",content:r.content}),{...e,messages:[...e.messages,...t],finalTranscripts:[],interimTranscript:""}}default:return e}},i={src:"/_next/static/media/mic.fcf852fd.svg",height:24,width:24,blurWidth:0,blurHeight:0},u={src:"/_next/static/media/mic-off.96b2642c.svg",height:24,width:24,blurWidth:0,blurHeight:0};let l={messages:[],finalTranscripts:[],interimTranscript:""};var o=function(){let[e,r]=(0,a.useReducer)(c,l),[t,o]=(0,a.useState)(!1),[d,f]=(0,a.useState)(!1),p=(0,a.useRef)(null),m=(0,a.useRef)(null),h=(0,a.useRef)(null),g=(0,a.useRef)(null),b=(0,a.useRef)(null),v=(0,a.useRef)([]),y=(0,a.useRef)(null);async function x(){let e=await navigator.mediaDevices.getUserMedia({audio:!0});m.current=new MediaRecorder(e),m.current.addEventListener("dataavailable",e=>{e.data.size>0&&p.current.readyState==WebSocket.OPEN&&p.current.send(e.data)}),m.current.start(250)}async function w(){r({type:"reset"});try{p.current=new WebSocket("wss://ai-groq-deepgram.onrender.com/listen"),p.current.binaryType="arraybuffer",p.current.onmessage=e=>{if(e.data instanceof ArrayBuffer){var t;t=e.data,v.current.push(new Uint8Array(t)),g.current&&!g.current.updating&&g.current.appendBuffer(v.current.shift())}else!function(e){let t=JSON.parse(e);"finish"===t.type?T():("transcript_final"===t.type&&b.current.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA&&function(){v.current=[];let e=g.current.buffered;e.length>0&&(g.current.updating&&g.current.abort(),b.current.currentTime=e.end(e.length-1))}(),r(t))}(e.data)},p.current.onclose=()=>{T()},await x(),function(){if(h.current="MediaSource"in window?new MediaSource:"ManagedMediaSource"in window?new ManagedMediaSource:(console.log("No MediaSource API available"),null),!h.current)return;h.current.addEventListener("sourceopen",()=>{MediaSource.isTypeSupported("audio/mpeg")&&(g.current=h.current.addSourceBuffer("audio/mpeg"),g.current.addEventListener("updateend",()=>{v.current.length>0&&!g.current.updating&&g.current.appendBuffer(v.current.shift())}))});let e=URL.createObjectURL(h.current);b.current=new Audio(e),b.current.play()}(),o(!0),f(!0)}catch(e){console.log("Error starting conversation:",e),T()}}function T(){p.current&&p.current.close(),m.current&&m.current.stream&&(m.current.stop(),m.current.stream.getTracks().forEach(e=>e.stop())),b.current&&(b.current.pause(),URL.revokeObjectURL(b.current.src),b.current=null),h.current&&(g.current&&(h.current.removeSourceBuffer(g.current),g.current=null),h.current=null),v.current=[],o(!1),f(!1)}(0,a.useLayoutEffect)(()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]);let j=[...e.finalTranscripts,e.interimTranscript].join(" ");return(0,n.jsxs)("div",{className:"flex flex-col h-svh pt-14 pb-4",children:[(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,n.jsx)("div",{className:"wave ".concat(t?"running":"")}),(0,n.jsx)("p",{className:"mt-14 text-[13px] text-primary-orange",children:t?'You can also end the conversation by saying "bye" or "goodbye"':"Click here to start a voice conversation with the assistant"}),(0,n.jsxs)("div",{className:"flex items-center mt-3 gap-6",children:[(0,n.jsx)("button",{className:"w-48 border border-primary-orange text-primary-orange font-semibold px-4 py-2 rounded-2xl hover:bg-primary-orange/5",onClick:t?T:w,children:t?"End conversation":"Start conversation"}),(0,n.jsx)("button",{className:"h-9 w-9 flex justify-center items-center bg-primary-orange rounded-full shadow-lg hover:opacity-70 disabled:opacity-70",onClick:function(){d?m.current.pause():m.current.resume(),f(!d)},disabled:!t,children:(0,n.jsx)(s.default,{src:d?i:u,height:21,width:21,alt:"microphone"})})]})]}),(0,n.jsx)("div",{className:"w-full max-w-[600px] mt-6 mx-auto overflow-y-auto",children:(0,n.jsxs)("div",{className:"flex flex-col items-start p-4 rounded-lg space-y-3",children:[e.messages.map((e,r)=>{let{role:t,content:a}=e;return(0,n.jsx)("div",{className:"user"===t?"user-bubble":"assistant-bubble",children:a},r)}),j&&(0,n.jsx)("div",{className:"user-bubble",children:j}),(0,n.jsx)("div",{ref:y})]})})]})}}},function(e){e.O(0,[648,971,23,744],function(){return e(e.s=6954)}),_N_E=e.O()}]);